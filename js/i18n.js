const translations = {
    en: {
        "nav-home": "Home",
        "nav-about": "About",
        "nav-farming": "Farming",
        "nav-community": "Community",
        "nav-dashboard": "Dashboard",
        "hero-title": "Better Farming, Better Harvest",
        "hero-desc": "Get expert advice based on your soil, reliable weather updates, and instant crop health checks.",
        "btn-check-farm": "Check My Farm",
        "btn-upload-crop": "Upload Crop Image",
        "feat-weather": "Weather Updates",
        "feat-weather-desc": "Know when to water and when to harvest.",
        "feat-soil": "Soil Analysis",
        "feat-soil-desc": "Understand your soil health and needs.",
        "feat-advice": "Crop Advice",
        "feat-advice-desc": "Expert recommendations for maximum yield.",
        "section-upload-title": "Instant Crop Doctor",
        "section-upload-desc": "Upload or take a picture of your crop to detect diseases instantly.",
        "btn-upload-img": "Upload Image",
        "dash-step-1": "Select Your Farm Location",
        "dash-instr-1": "Tap anywhere on the map to mark your land, or use \"My GPS Location\".",
        "btn-gps": "Use My GPS Location",
        "loc-selected": "Selected:",
        "dash-step-2": "Recommended Crops for You",
        "dash-instr-2": "Based on your location and season.",
        "soil-check": "Quick Soil Check",
        "soil-instr": "Refine recommendations by adding soil details.",
        "lbl-soil-type": "Soil Type:",
        "opt-select-soil": "Select Soil Type",
        "btn-update-advice": "Update Advice",
        "health-scan": "Crop Health Scan",
        "scan-instr": "Take a photo of a leaf to check for diseases.",
        "btn-scan-now": "Scan Now",
        "scanning": "Analyzing...",
        "sec-community": "Community",
        "community-desc": "See success stories from farmers like you.",
        "lbl-crop": "Crop:",
        "lbl-yield": "Yield:",
        "story-1-name": "Ramesh, Punjab",
        "story-1-quote": "Smart Crop Advisory helped me choose the right time for sowing. Yield increased significantly!",
        "story-2-name": "Lakshmi, Tamil Nadu",
        "story-2-quote": "The disease detection feature saved my rice crop from severe blight. Very useful app!",
        "story-3-name": "Venkat, Telangana",
        "story-3-quote": "Soil analysis is very accurate. I used the recommended fertilizers and got high quality cotton.",
        "voice-welcome": "Welcome to Smart Crop Advisory. How can I help you today?"
    },
    hi: {
        "nav-home": "होम",
        "nav-about": "हमारे बारे में",
        "weather-wind": "हवा",
        "about-title": "क्रॉप स्मार्ट के बारे में",
        "about-p1": "क्रॉप स्मार्ट एक स्मार्ट कृषि सहायता एप्लिकेशन है जिसे आधुनिक तकनीक का उपयोग करके किसानों को बेहतर फसल उगाने के निर्णय लेने में मदद करने के लिए डिज़ाइन किया गया है।",
        "about-p2": "किसान के वर्तमान स्थान का उपयोग करके, क्रॉप स्मार्ट स्वचालित रूप से महत्वपूर्ण पर्यावरणीय कारकों की पहचान करता है।",
        "about-p3": "क्रॉप स्मार्ट में एक इमेज अपलोड सुविधा भी शामिल है, जिससे किसान अपनी भूमि या मिट्टी की तस्वीरें ले सकते हैं या अपलोड कर सकते हैं।",
        "about-p4": "क्रॉप स्मार्ट का मुख्य लक्ष्य फसल की उपज बढ़ाना, खेती के जोखिमों को कम करना और किसान की आय में सुधार करना है।",
        "about-p5": "क्रॉप स्मार्ट एक डिजिटल कृषि सहायक के रूप में कार्य करता है, जो किसानों को समय पर जानकारी के साथ सशक्त बनाता है।",
        "nav-farming": "खेती",
        "nav-community": "समुदाय",
        "nav-dashboard": "डैशबोर्ड",
        "hero-title": "बेहतर खेती, बेहतर फसल",
        "hero-desc": "अपनी मिट्टी के आधार पर विशेषज्ञ सलाह, विश्वसनीय मौसम अपडेट और त्वरित फसल स्वास्थ्य जांच प्राप्त करें।",
        "btn-check-farm": "मेरा खेत देखें",
        "btn-upload-crop": "फसल की फोटो अपलोड करें",
        "feat-weather": "मौसम अपडेट",
        "feat-weather-desc": "जानिए कब पानी देना है और कब कटाई करनी है।",
        "feat-soil": "मिट्टी की जांच",
        "feat-soil-desc": "अपनी मिट्टी के स्वास्थ्य और जरूरतों को समझें।",
        "feat-advice": "फसल सलाह",
        "feat-advice-desc": "अधिकतम उपज के लिए विशेषज्ञ सिफारिशें।",
        "section-upload-title": "त्वरित फसल डॉक्टर",
        "section-upload-desc": "बीमारियों का तुरंत पता लगाने के लिए अपनी फसल की तस्वीर अपलोड करें या लें।",
        "btn-upload-img": "तस्वीर अपलोड करें",
        "dash-step-1": "अपने खेत का स्थान चुनें",
        "dash-instr-1": "अपनी जमीन को चिह्नित करने के लिए मानचित्र पर कहीं भी टैप करें, या \"जीपीएस\" का उपयोग करें।",
        "btn-gps": "मेरे जीपीएस लोकेशन का उपयोग करें",
        "loc-selected": "चुना गया:",
        "dash-step-2": "आपके लिए अनुशंसित फसलें",
        "dash-instr-2": "आपके स्थान और मौसम के आधार पर।",
        "soil-check": "त्वरित मिट्टी जांच",
        "soil-instr": "मिट्टी का विवरण जोड़कर सिफारिशों को बेहतर बनाएं।",
        "lbl-soil-type": "मिट्टी का प्रकार:",
        "opt-select-soil": "मिट्टी का प्रकार चुनें",
        "btn-update-advice": "सलाह अपडेट करें",
        "health-scan": "फसल स्वास्थ्य स्कैन",
        "scan-instr": "बीमारियों की जांच के लिए पत्ती की फोटो लें।",
        "btn-scan-now": "अभी स्कैन करें",
        "scanning": "विश्लेषण हो रहा है...",
        "sec-community": "किसान समुदाय",
        "community-desc": "अपने जैसे अन्य किसानों की सफलता की कहानियाँ देखें।",
        "lbl-crop": "फसल:",
        "lbl-yield": "उपज:",
        "story-1-name": "रमेश, पंजाब",
        "story-1-quote": "स्मार्ट क्रॉप एडवाइजरी ने मुझे बुवाई के लिए सही समय चुनने में मदद की। उपज में 20% की वृद्धि हुई!",
        "story-2-name": "लक्ष्मी, तमिलनाडु",
        "story-2-quote": "रोग का पता लगाने वाली सुविधा ने मेरी धान की फसल को गंभीर झुलसा रोग से बचाया। बहुत उपयोगी ऐप!",
        "story-3-name": "वेंकट, तेलंगाना",
        "story-3-quote": "मिट्टी का विश्लेषण बहुत सटीक है। मैंने सिफारिश की गई खाद का उपयोग किया और उच्च गुणवत्ता वाला कपास प्राप्त किया।",
        "voice-welcome": "स्मार्ट क्रॉप एडवाइजरी में आपका स्वागत है। आज मैं आपकी कैसे मदद कर सकता हूँ?"
    },
    ta: {
        "nav-home": "முகப்பு",
        "nav-about": "எங்களைப் பற்றி",
        "nav-farming": "விவசாயம்",
        "nav-community": "சமூகம்",
        "nav-dashboard": "டாஷ்போர்டு",
        "hero-title": "சிறந்த விவசாயம், சிறந்த அறுவடை",
        "hero-desc": "உங்கள் மண், நம்பகமான வானிலை அறிவிப்புகள் மற்றும் உடனடி பயிர் ஆரோக்கிய சோதனைகளின் அடிப்படையில் நிபுணர் ஆலோசனையைப் பெறுங்கள்.",
        "btn-check-farm": "என் பண்ணையைச் சரிபார்க்கவும்",
        "btn-upload-crop": "பயிர் படத்தை பதிவேற்றவும்",
        "feat-weather": "வானிலை அறிவிப்புகள்",
        "feat-weather-desc": "எப்போது தண்ணீர் பாய்ச்ச வேண்டும் மற்றும் எப்போது அறுவடை செய்ய வேண்டும் என்பதை அறியவும்.",
        "feat-soil": "மண் ஆய்வு",
        "feat-soil-desc": "உங்கள் மண்ணின் ஆரோக்கியம் மற்றும் தேவைகளைப் புரிந்து கொள்ளுங்கள்.",
        "feat-advice": "பயிர் ஆலோசனை",
        "feat-advice-desc": "அதிகபட்ச விளைச்சலுக்கான நிபுணர் பரிந்துரைகள்.",
        "section-upload-title": "உடனடி பயிர் மருத்துவர்",
        "section-upload-desc": "நோய்களை உடனடியாகக் கண்டறிய உங்கள் பயிரின் படத்தை பதிவேற்றவும் அல்லது எடுக்கவும்.",
        "btn-upload-img": "படத்தை பதிவேற்றவும்",
        "dash-step-1": "உங்கள் பண்ணை இருப்பிடத்தைத் தேர்ந்தெடுக்கவும்",
        "dash-instr-1": "உங்கள் நிலத்தைக் குறிக்க வரைபடத்தில் எங்கு வேண்டுமானாலும் தட்டவும் அல்லது \"எனது GPS இருப்பிடம்\" பயன்படுத்தவும்.",
        "btn-gps": "எனது GPS இருப்பிடத்தைப் பயன்படுத்தவும்",
        "loc-selected": "தேர்ந்தெடுக்கப்பட்டது:",
        "dash-step-2": "உங்களுக்காகப் பரிந்துரைக்கப்படும் பயிர்கள்",
        "dash-instr-2": "உங்கள் இருப்பிடம் மற்றும் பருவத்தின் அடிப்படையில்.",
        "soil-check": "விரைவான மண் சரிபார்ப்பு",
        "soil-instr": "மண் விவரங்களைச் சேர்ப்பதன் மூலம் பரிந்துரைகளைச் செம்மைப்படுத்தவும்.",
        "lbl-soil-type": "மண் வகை:",
        "opt-select-soil": "மண் வகையைத் தேர்ந்தெடுக்கவும்",
        "btn-update-advice": "ஆலோசனையைப் புதுப்பிக்கவும்",
        "health-scan": "பயிர் ஆரோக்கிய ஸ்கேன்",
        "scan-instr": "நோய்களைச் சரிபார்க்க இலையின் புகைப்படத்தை எடுக்கவும்.",
        "btn-scan-now": "இப்போது ஸ்கேன் செய்யவும்",
        "scanning": "பகுப்பாய்வு செய்கிறது...",
        "sec-community": "விவசாயிகள் சமூகம்",
        "community-desc": "உங்களைப் போன்ற விவசாயிகளின் வெற்றிக் கதைகளைப் பாருங்கள்.",
        "lbl-crop": "பயிர்:",
        "lbl-yield": "விளைச்சல்:",
        "story-1-name": "ரமேஷ், பஞ்சாப்",
        "story-1-quote": "விதைப்பதற்கு சரியான நேரத்தைத் தேர்வுசெய்ய ஸ்மார்ட் கிராப் அட்வைசரி எனக்கு உதவியது. விளைச்சல் 20% அதிகரித்துள்ளது!",
        "story-2-name": "லட்சுமி, தமிழ்நாடு",
        "story-2-quote": "நோய் கண்டறிதல் அம்சம் எனது நெற்பயிரை கடுமையான கருகல் நோயிலிருந்து காப்பாற்றியது. மிகவும் பயனுள்ள செயலி!",
        "story-3-name": "வெங்கட், தெலுங்கானா",
        "story-3-quote": "மண் பகுப்பாய்வு மிகவும் துல்லியமானது. நான் பரிந்துரைக்கப்பட்ட உரங்களைப் பயன்படுத்தினேன் மற்றும் உயர்தரம் பெற்றேன்.",
        "voice-welcome": "ஸ்மார்ட் பயிர் ஆலோசனைக்கு வரவேற்கிறோம். இன்று நான் உங்களுக்கு எப்படி உதவ முடியும்?"
    },
    te: {
        "nav-home": "హోమ్",
        "nav-about": "మా గురించి",
        "nav-farming": "వ్యవసాయం",
        "nav-community": "సంఘం",
        "nav-dashboard": "డ్యాష్‌బోర్డ్",
        "hero-title": "మంచి వ్యవసాయం, మంచి పంట",
        "hero-desc": "మీ నేల, నమ్మకమైన వాతావరణ అప్‌డేట్‌లు మరియు తక్షణ పంట ఆరోగ్య తనిఖీల ఆధారంగా నిపుణుల సలహాలను పొందండి.",
        "btn-check-farm": "నా పొలాన్ని తనిఖీ చేయండి",
        "btn-upload-crop": "పంట చిత్రాన్ని అప్‌లోడ్ చేయండి",
        "feat-weather": "వాతావరణ అప్‌డేట్‌లు",
        "feat-weather-desc": "ఎప్పుడు నీరు పెట్టాలి మరియు ఎప్పుడు కోయాలి అనేది తెలుసుకోండి.",
        "feat-soil": "నేల విశ్లేషణ",
        "feat-soil-desc": "మీ నేల ఆరోగ్యం మరియు అవసరాలను అర్థం చేసుకోండి.",
        "feat-advice": "పంట సలహా",
        "feat-advice-desc": "గరిష్ట దిగుబడి కోసం నిపుణుల సిఫార్సులు.",
        "section-upload-title": "తక్షణ పంట డాక్టర్",
        "section-upload-desc": "వ్యాధులను తక్షణమే గుర్తించడానికి మీ పంట చిత్రాన్ని అప్‌లోడ్ చేయండి లేదా తీసుకోండి.",
        "btn-upload-img": "చిత్రాన్ని అప్‌లోడ్ చేయండి",
        "dash-step-1": "మీ పొలం స్థానాన్ని ఎంచుకోండి",
        "dash-instr-1": "మీ భూమిని గుర్తించడానికి మ్యాప్‌లో ఎక్కడైనా నొక్కండి లేదా \"నా GPS స్థానం\" ఉపయోగించండి.",
        "btn-gps": "నా GPS స్థానాన్ని ఉపయోగించండి",
        "loc-selected": "ఎంచుకోబడింది:",
        "dash-step-2": "మీ కోసం సిఫార్సు చేయబడిన పంటలు",
        "dash-instr-2": "మీ స్థానం మరియు సీజన్ ఆధారంగా.",
        "soil-check": "త్వరిత నేల తనిఖీ",
        "soil-instr": "నేల వివరాలను జోడించడం ద్వారా సిఫార్సులను మెరుగుపరచండి.",
        "lbl-soil-type": "నేల రకం:",
        "opt-select-soil": "నేల రకాన్ని ఎంచుకోండి",
        "btn-update-advice": "సలహాను నవీకరించండి",
        "health-scan": "పంట ఆరోగ్య స్కాన్",
        "scan-instr": "వ్యాధులను తనిఖీ చేయడానికి ఆకు ఫోటో తీసుకోండి.",
        "btn-scan-now": "ఇప్పుడే స్కాన్ చేయండి",
        "scanning": "విశ్లేషించడం...",
        "sec-community": "రైతు సంఘం",
        "community-desc": "మీలాంటి రైతుల విజయ గాథలను చూడండి.",
        "lbl-crop": "పంట:",
        "lbl-yield": "దిగుబడి:",
        "story-1-name": "రమేష్, పంజాబ్",
        "story-1-quote": "విత్తడానికి సరైన సమయాన్ని ఎంచుకోవడానికి స్మార్ట్ క్రాప్ అడ్వైజరీ నాకు సహాయపడింది. దిగుబడి 20% పెరిగింది!",
        "story-2-name": "లక్ష్మి, తమిళనాడు",
        "story-2-quote": "వ్యాధి గుర్తింపు ఫీచర్ నా వరి పంటను తీవ్రమైన తెగులు నుండి కాపాడింది. చాలా ఉపయోగకరమైన యాప్!",
        "story-3-name": "వెంకట్, తెలంగాణ",
        "story-3-quote": "నేల విశ్లేషణ చాలా ఖచ్చితమైనది. నేను సిఫార్సు చేసిన ఎరువులు వాడాను మరియు అధిక నాణ్యత గల పత్తిని పొందాను.",
        "voice-welcome": "స్మార్ట్ క్రాప్ అడ్వైజరీకి స్వాగతం. ఈ రోజు నేను మీకు ఎలా సహాయడగలను?"
    },
    kn: {
        "nav-home": "ಮುಖಪುಟ",
        "nav-about": "ನಮ್ಮ ಬಗ್ಗೆ",
        "nav-farming": "ಕೃಷಿ",
        "nav-community": "ಸಮುದಾಯ",
        "nav-dashboard": "ಡ್ಯಾಶ್‌ಬೋರ್ಡ್",
        "hero-title": "ಉತ್ತಮ ಕೃಷಿ, ಉತ್ತಮ ಫಸಲು",
        "hero-desc": "ನಿಮ್ಮ ಮಣ್ಣು, ವಿಶ್ವಾಸಾರ್ಹ ಹವಾಮಾನ ನವೀಕರಣಗಳು ಮತ್ತು ತ್ವರಿತ ಬೆಳೆ ಆರೋಗ್ಯ ತಪಾಸಣೆಗಳ ಆಧಾರದ ಮೇಲೆ ತಜ್ಞರ ಸಲಹೆಯನ್ನು ಪಡೆಯಿರಿ.",
        "btn-check-farm": "ನನ್ನ ಹೊಲವನ್ನು ಪರಿಶೀಲಿಸಿ",
        "btn-upload-crop": "ಬೆಳೆ ಚಿತ್ರವನ್ನು ಅಪ್‌ಲೋಡ್ ಮಾಡಿ",
        "feat-weather": "ಹವಾಮಾನ ನವೀಕರಣಗಳು",
        "feat-weather-desc": "ಯಾವಾಗ ನೀರು ಹಾಕಬೇಕು ಮತ್ತು ಯಾವಾಗ ಕಟಾವು ಮಾಡಬೇಕು ಎಂದು ತಿಳಿಯಿರಿ.",
        "feat-soil": "ಮಣ್ಣಿನ ವಿಶ್ಲೇಷಣೆ",
        "feat-soil-desc": "ನಿಮ್ಮ ಮಣ್ಣಿನ ಆರೋಗ್ಯ ಮತ್ತು ಅಗತ್ಯಗಳನ್ನು ಅರ್ಥಮಾಡಿಕೊಳ್ಳಿ.",
        "feat-advice": "ಬೆಳೆ ಸಲಹೆ",
        "feat-advice-desc": "ಗರಿಷ್ಠ ಇಳುವರಿಗಾಗಿ ತಜ್ಞರ ಶಿಫಾರಸುಗಳು.",
        "section-upload-title": "ತ್ವರಿತ ಬೆಳೆ ವೈದ್ಯ",
        "section-upload-desc": "ರೋಗಗಳನ್ನು ತಕ್ಷಣವೇ ಪತ್ತೆಹಚ್ಚಲು ನಿಮ್ಮ ಬೆಳೆಯ ಚಿತ್ರವನ್ನು ಅಪ್‌ಲೋಡ್ ಮಾಡಿ ಅಥವಾ ತೆಗೆದುಕೊಳ್ಳಿ.",
        "btn-upload-img": "ಚಿತ್ರವನ್ನು ಅಪ್‌ಲೋಡ್ ಮಾಡಿ",
        "dash-step-1": "ನಿಮ್ಮ ಹೊಲದ ಸ್ಥಳವನ್ನು ಆಯ್ಕೆಮಾಡಿ",
        "dash-instr-1": "ನಿಮ್ಮ ಜಮೀನನ್ನು ಗುರುತಿಸಲು ನಕ್ಷೆಯಲ್ಲಿ ಎಲ್ಲಿಯಾದರೂ ಟ್ಯಾಪ್ ಮಾಡಿ, ಅಥವಾ \"ನನ್ನ GPS ಸ್ಥಳ\" ಬಳಸಿ.",
        "btn-gps": "ನನ್ನ GPS ಸ್ಥಳವನ್ನು ಬಳಸಿ",
        "loc-selected": "ಆಯ್ಕೆಮಾಡಲಾಗಿದೆ:",
        "dash-step-2": "ನಿಮಗಾಗಿ ಶಿಫಾರಸು ಮಾಡಲಾದ ಬೆಳೆಗಳು",
        "dash-instr-2": "ನಿಮ್ಮ ಸ್ಥಳ ಮತ್ತು ಋತುವಿನ ಆಧಾರದ ಮೇಲೆ.",
        "soil-check": "ತ್ವರಿತ ಮಣ್ಣು ತಪಾಸಣೆ",
        "soil-instr": "ಮಣ್ಣಿನ ವಿವರಗಳನ್ನು ಸೇರಿಸುವ ಮೂಲಕ ಶಿಫಾರಸುಗಳನ್ನು ಪರಿಷ್ಕರಿಸಿ.",
        "lbl-soil-type": "ಮಣ್ಣಿನ ಪ್ರಕಾರ:",
        "opt-select-soil": "ಮಣ್ಣಿನ ಪ್ರಕಾರವನ್ನು ಆಯ್ಕೆಮಾಡಿ",
        "btn-update-advice": "ಸಲಹೆಯನ್ನು ನವೀಕರಿಸಿ",
        "health-scan": "ಬೆಳೆ ಆರೋಗ್ಯ ಸ್ಕ್ಯಾನ್",
        "scan-instr": "ರೋಗಗಳನ್ನು ಪರೀಕ್ಷಿಸಲು ಎಲೆಯ ಫೋಟೋ ತೆಗೆದುಕೊಳ್ಳಿ.",
        "btn-scan-now": "ಈಗಲೇ ಸ್ಕ್ಯಾನ್ ಮಾಡಿ",
        "scanning": "ವಿಶ್ಲೇಷಿಸಲಾಗುತ್ತಿದೆ...",
        "sec-community": "ರೈತ ಸಮುದಾಯ",
        "community-desc": "ನಿಮ್ಮಂತೆಯೇ ಇರುವ ಇತರ ರೈತರ ಯಶಸ್ಸಿನ ಕಥೆಗಳನ್ನು ನೋಡಿ.",
        "lbl-crop": "ಬೆಳೆ:",
        "lbl-yield": "ಇಳುವರಿ:",
        "story-1-name": "ರಮೇಶ್, ಪಂಜಾಬ್",
        "story-1-quote": "ಬಿತ್ತನೆಗೆ ಸರಿಯಾದ ಸಮಯವನ್ನು ಆಯ್ಕೆ ಮಾಡಲು ಸ್ಮಾರ್ಟ್ ಕ್ರಾಪ್ ಅಡ್ವೈಸರಿ ನನಗೆ ಸಹಾಯ ಮಾಡಿದೆ. ಇಳುವರಿ 20% ಹೆಚ್ಚಾಗಿದೆ!",
        "story-2-name": "ಲಕ್ಷ್ಮಿ, ತಮಿಳುನಾಡು",
        "story-2-quote": "ರೋಗ ಪತ್ತೆ ಹಚ್ಚುವ ವೈಶಿಷ್ಟ್ಯವು ನನ್ನ ಭತ್ತದ ಬೆಳೆಯನ್ನು ತೀವ್ರವಾದ ರೋಗದಿಂದ ಉಳಿಸಿದೆ. ತುಂಬಾ ಉಪಯುಕ್ತ ಅಪ್ಲಿಕೇಶನ್!",
        "story-3-name": "ವೆಂಕಟ್, ತೆಲಂಗಾಣ",
        "story-3-quote": "ಮಣ್ಣಿನ ವಿಶ್ಲೇಷಣೆ ತುಂಬಾ ನಿಖರವಾಗಿದೆ. ನಾನು ಶಿಫಾರಸು ಮಾಡಿದ ರಸಗೊಬ್ಬರಗಳನ್ನು ಬಳಸಿದ್ದೇನೆ ಮತ್ತು ಉತ್ತಮ ಗುಣಮಟ್ಟದ ಹತ್ತಿಯನ್ನು ಪಡೆದಿದ್ದೇನೆ.",
        "voice-welcome": "ಸ್ಮಾರ್ಟ್ ಕ్రాಪ್ ಅಡ್ವೈಸರಿಗೆ ಸುಸ್ವಾಗತ. ಇಂದು ನಾನು ನಿಮಗೆ ಹೇಗೆ ಸಹಾಯ ಮಾಡಬಹುದು?"
    }
};

let currentLang = localStorage.getItem('appLang') || 'en';

function changeLanguage(lang) {
    if (!translations[lang]) return;
    currentLang = lang;
    localStorage.setItem('appLang', lang);

    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[lang][key]) {
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translations[lang][key];
            } else {
                element.innerHTML = translations[lang][key]; // Using innerHTML to preserve icons if included in translation values (though ideally icons should be separate)
            }
        }
    });

    // Update dropdown if exists
    const langSelect = document.getElementById('language-select');
    if (langSelect) langSelect.value = lang;
}

function speakText(textKey) {
    const text = translations[currentLang][textKey] || translations['en'][textKey];
    if (!text) return;

    if ('speechSynthesis' in window) {
        // Cancel existing speech
        window.speechSynthesis.cancel();

        const utterance = new SpeechSynthesisUtterance(text);

        // Try to set voice based on language
        // Note: Voice availability depends on OS/Browser
        const voices = window.speechSynthesis.getVoices();
        // A simple heuristic to find a matching voice
        const langCodeMap = {
            'en': 'en-IN', // Prefer Indian English
            'hi': 'hi-IN',
            'ta': 'ta-IN',
            'te': 'te-IN',
            'kn': 'kn-IN'
        };

        const targetLang = langCodeMap[currentLang] || currentLang;
        const voice = voices.find(v => v.lang.includes(targetLang));

        if (voice) utterance.voice = voice;

        utterance.lang = targetLang;
        utterance.rate = 0.9; // Slightly slower for clarity

        window.speechSynthesis.speak(utterance);
    } else {
        alert("Text-to-speech not supported in this browser.");
    }
}

// Initial Load
document.addEventListener('DOMContentLoaded', () => {
    // Populate or set initial language
    changeLanguage(currentLang);

    // Voice support availability check (optional UI update)
});

// Expose functions globally
window.changeLanguage = changeLanguage;
window.speakText = speakText;
